var menuCache=[];layui.config({base:"/layui/lay/modules/"}).use(["navbar","tab","layer","code","element","jquery","form"],function(){var e=layui.navbar(),r=layui.layer,i=layui.form,d=layui.jquery;layui.element;layui.code();var n=layui.tab();n.set({elem:"#tabs",autoRefresh:!0,closed:!0});e.set({elem:"#nav_bar",data:[{id:"2",title:"库存管理",icon:"&#xe63c;",href:"",spread:!1,children:[{id:"4",title:"供货商管理",icon:"&#xe62e;",href:"/stock/supplier_control",spread:!1},{id:"3",title:"货品库存",icon:"&#xe68e;",href:"/stock/stock_control",spread:!1}]},{id:"9",title:"销售管理",icon:"&#xe61c;",href:"",spread:!1,children:[{id:"9292",title:"客户管理",icon:"&#xe613;",href:"/sales/customer_control",spread:!1},{id:"99",title:"销售订单",icon:"&#xe609;",href:"/sales/sales_control",spread:!1},{id:"992",title:"订单异常处理",icon:"&#xe60a;",href:"/comingSoon",spread:!1},{id:"41",title:"销售业绩（个人）",icon:"&#xe62f;",href:"/comingSoon",spread:!1}]},{id:"6",title:"报表与数据",icon:"&#xe61c;",href:"",spread:!1,children:[{id:"939",title:"销售数据统计",icon:"&#xe62c;",href:"/comingSoon",spread:!1},{id:"9292",title:"库存数据统计",icon:"&#xe632;",href:"/comingSoon",spread:!1},{id:"441",title:"客户活跃统计",icon:"&#xe604;",href:"/comingSoon",spread:!1}]},{id:"8",title:"系统设置",icon:"&#xe620;",href:"",spread:!1,children:[{id:"9",title:"用户管理",icon:"&#xe612;",href:"/user/user_control",spread:!1},{id:"10",title:"用户组与权限",icon:"&#xe770;",href:"/comingSoon",spread:!1}]}],cached:!0}),e.render(),e.on("click(nav_bar)",function(e){var o={title:e.field.title,href:e.field.href,icon:e.field.icon,id:e.field.id};n.tabAdd(o),menuCache.push(o)}),d("#main_password_modify").on("click",function(){r.open({content:"/user/modify_password",type:2,anim:2,title:"修改密码",btn:["修改","取消"],skin:"layui-layer-rim",area:["450px","280px"],success:function(e,o){i.render()},yes:function(n,e){var o=r.getChildFrame("form",n),i=o.contents().find("#password").val(),s=o.contents().find("#newPassword").val(),t=o.contents().find("#newPasswordRepeat").val(),l=new CommonValidationUtils,c=new CommonValidationEmu;if(l.isNull(i)||l.isNull(t)||l.isNull(s))r.msg(c.errorMsg.all_not_null);else if(s==t){var a=r.load(2);d.post("/user/modify_password",{password:i,newPassword:s},function(e,o,i){r.close(a),0==e.code?(r.close(n),r.msg("用户密码已修改成功！")):r.msg(e.message)},"json")}else r.msg("两次输入的新密码不一致，请重新输入。")}})});var o=d(".site-tree-mobile"),s=d(".site-mobile-shade");o.on("click",function(){d("body").addClass("site-mobile")}),s.on("click",function(){d("body").removeClass("site-mobile")}),"true"==window.sessionStorage.getItem("lockcms")&&r.open({title:!1,type:1,content:d("#lock-box"),closeBtn:0,shade:.4}),d(".lockcms").on("click",function(){window.sessionStorage.setItem("lockcms",!0),r.open({title:!1,type:1,content:d("#lock-box"),closeBtn:0,shade:.4})}),d("#unlock").on("click",function(){""==d(this).siblings(".admin-header-lock-input").val()?r.msg("请输入解锁密码！"):d.ajax({url:"/login",type:"POST",dataType:"json",data:{username:d("#lockUserName").html(),password:d(this).siblings(".admin-header-lock-input").val()},success:function(e){e.status?(window.sessionStorage.setItem("lockcms",!1),d(this).siblings(".admin-header-lock-input").val(""),r.closeAll(),d(".admin-header-lock").hide()):r.msg("密码错误，请重新输入！")}})}),d(document).on("keydown",function(){13==event.keyCode&&d("#unlock").click()}),setInterval(function(){"true"==window.sessionStorage.getItem("lockcms")&&(window.sessionStorage.setItem("lockcms",!1),window.location.href="/"),d.post("/validateUserValid",{t:(new Date).getTime()},function(e,o,i){0!=e.code?(d(".lockcms").click(),console.log("登录状态已失效...")):console.log("登录状态有效...")},"json")},6e4)});