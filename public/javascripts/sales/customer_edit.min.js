layui.use(["form","layer","table","jquery","element"],function(){var n=layui.jquery,e=layui.form,l=layui.layer,i=layui.table;layui.element;i.render({elem:"#cus_table_container",id:"cus_table",page:!1,data:r,cols:[[{field:"name",minWidth:"150",align:"center",title:"姓名"},{field:"cellphone",minWidth:"150",align:"center",title:"移动电话"},{field:"email",minWidth:"150",align:"center",title:"Email"},{field:"address",minWidth:"150",align:"center",title:"地址"},{align:"center",minWidth:"150",title:"操作",toolbar:"#table_control_bar"}]],loading:!0});var r=[];if(0<n("#customerLink").length){for(var a=n.parseJSON(n("#customerLink").val()),t=0;t<a.length;t++){var d={id:a[t].id,name:a[t].name,cellphone:a[t].cellphone,email:a[t].email,address:a[t].address};r.push(d)}JSON.stringify(JSON.stringify(r)),n("#cus_table_container").attr("data",JSON.stringify(r)),i.reload("cus_table",{data:r})}e.render(),n("#addNewCusBtn").on("click",function(){l.open({content:n("#addCustom").html(),type:1,anim:2,title:"编辑联系人",btn:["保存","取消"],skin:"layui-layer-rim",area:["500px","90%"],success:function(){n(".layui-layer-btn0",parent.document).hide()},yes:function(e,a){var t={id:(new Date).getTime(),name:n("#tmp_add_name").val(),cellphone:n("#tmp_add_cellphoneNo").val(),email:n("#tmp_add_email").val(),address:n("#tmp_add_address").val()};""!=t.name&&""!=t.address&&""!=t.cellphone&&""!=t.email?(r.push(t),n("#cus_table_container").attr("data",JSON.stringify(r)),i.reload("cus_table",{data:r}),l.close(e)):l.msg("字段[姓名、地址、电话、email]均不能为空。")},end:function(){n(".layui-layer-btn0",parent.document).show()}})}),i.on("tool(cus_table_container)",function(e){e.data;var a=e.event;e.tr;if("deletCusbtn"===a){for(var t=[],l=0;l<r.length;l++)r[l].id!=e.data.id&&t.push(r[l]);i.reload("cus_table",{data:t}),r=t,n("#cus_table_container").attr("data",JSON.stringify(r))}})});