var tab;layui.config({base:"js/",version:(new Date).getTime()}).use(["element","layer","navbar","tab"],function(){layui.element();var n=layui.jquery,t=layui.layer,e=layui.navbar();tab=layui.tab({elem:".admin-nav-card",contextMenu:!0,onSwitch:function(e){console.log(e.id),console.log(e.index),console.log(e.elem),console.log(tab.getCurrentTabId())},closeBefore:function(n){return console.log(n),"BTable"===n.title?(t.confirm("确定要关闭"+n.title+"吗?",{icon:3,title:"系统提示"},function(e){tab.deleteTab(n.tabId),t.close(e)}),!1):"表单"!==n.title||(t.confirm("未保存的数据可能会丢失哦，确定要关闭吗?",{icon:3,title:"系统提示"},function(e){tab.deleteTab(n.tabId),t.close(e)}),!1)}}),n(window).on("resize",function(){var e=n(".admin-nav-card .layui-tab-content");e.height(n(this).height()-147),e.find("iframe").each(function(){n(this).height(e.height())})}).resize(),e.set({spreadOne:!0,elem:"#admin-navbar-side",cached:!0,data:navs}),e.render(),e.on("click(side)",function(e){tab.tabAdd(e.field)}),n("#clearCached").on("click",function(){e.cleanCached(),t.alert("清除完成!",{icon:1,title:"系统提示"},function(){location.reload()})}),n(".admin-side-toggle").on("click",function(){200===n("#admin-side").width()?(n("#admin-body").animate({left:"0"}),n("#admin-footer").animate({left:"0"}),n("#admin-side").animate({width:"0"})):(n("#admin-body").animate({left:"200px"}),n("#admin-footer").animate({left:"200px"}),n("#admin-side").animate({width:"200px"}))}),n(".admin-side-full").on("click",function(){var e=document.documentElement;e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullScreen?e.webkitRequestFullScreen():elem.msRequestFullscreen&&elem.msRequestFullscreen(),t.msg("按Esc即可退出全屏")}),n("#setting").on("click",function(){tab.tabAdd({href:"/Manage/Account/Setting/",icon:"fa-gear",title:"设置"})}),n(document).on("keydown",function(){var e=window.event;76===e.keyCode&&e.altKey&&lock(n,t)}),n("#lock").on("click",function(){lock(n,t)});var i=n(".site-tree-mobile"),o=n(".site-mobile-shade");i.on("click",function(){n("body").addClass("site-mobile")}),o.on("click",function(){n("body").removeClass("site-mobile")})});var isShowLock=!1;function lock(o,a){isShowLock||a.open({title:!1,type:1,closeBtn:0,anim:6,content:o("#lock-temp").html(),shade:[.9,"#393D49"],success:function(e,t){isShowLock=!0,e.find("input[name=password]").on("focus",function(){var e=o(this);"输入密码解锁.."===e.val()&&e.val("").attr("type","password")}).on("blur",function(){var e=o(this);""!==e.val()&&0!==e.length||e.attr("type","text").val("输入密码解锁..")}),o.getJSON("/Account/Logout",null,function(e){e.rel||a.msg(e.msg)},"json"),e.find("button#unlock").on("click",function(){var e=o("div#lock-box"),n=e.find("input[name=username]").val(),t=e.find("input[name=password]").val();"输入密码解锁.."!==t&&0!==t.length?i(n,t):a.msg("请输入密码..",{icon:2,time:1e3})});var i=function(e,n){console.log(e,n),o.post("/Account/UnLock",{userName:e,password:n},function(e){e.rel?(a.close(t),isShowLock=!1):a.msg(e.msg,{icon:2,time:1e3})},"json")}}})}