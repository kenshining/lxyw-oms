layui.use(["form","layer","element","jquery","table"],function(){var c=layui.jquery,r=(layui.form,layui.layer),n=layui.table;layui.element;c("#add").on("click",function(){var e=r.open({content:"/sales/customer_edit",type:2,anim:2,title:"编辑客户信息",btn:["保存","取消"],success:function(e,t){},yes:function(l,e){var t=r.getChildFrame("#customer_form",l),s=c.parseJSON(t.contents().find("#cus_table_container").attr("data")),a=r.load(2);c.post("/sales/customer_save",{customerName:t.contents().find("#customer_name").val(),customerType:t.contents().find("#customer_type").val(),customerCellphone:t.contents().find("#customer_cellphone").val(),customerEmail:t.contents().find("#customer_email").val(),customerAddress:t.contents().find("#customer_address").val(),customerRmarks:t.contents().find("#customer_remarks").val(),custlist:JSON.stringify(s)},function(e,t,s){r.close(a),0==e.code?(r.close(l),r.msg("客户信息成功"),n.reload("customer_search_table")):r.msg("保存失败："+e.message)},"json")}});r.full(e)}),n.render({elem:"#table_content",id:"customer_search_table",url:"/sales/customer_findByPage",where:{t:(new Date).getTime(),customerName:c("#cust_search_name").val(),customerCellphone:c("#cust_search_cellphone").val(),customerType:c("#cust_search_type").val()},cols:[[{field:"customerName",align:"center",title:"客户名称"},{field:"customerType",align:"center",title:"客户类别"},{field:"customerCellphone",align:"center",title:"客户电话"},{field:"customerEmail",align:"center",title:"Email"},{field:"customerAddress",align:"center",title:"客户地址"},{fixed:"right",align:"center",title:"操作",toolbar:"#table_control_bar"}]],page:!0,loading:!0,limits:[10,20,50,90]}),c("#search").on("click",function(){n.reload("customer_search_table",{where:{t:(new Date).getTime(),customerName:c("#cust_search_name").val(),customerCellphone:c("#cust_search_cellphont").val(),customerType:c("#cust_search_type").val()}})})});