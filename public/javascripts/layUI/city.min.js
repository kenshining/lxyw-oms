layui.define(["jquery"],function(e){"use strict";var u,o=layui.jquery;(u=o).support.cors=!0,u.fn.citys=function(e,v){"function"==typeof e?(v=e,e={}):(e=e||{},v=v||function(){});var f=u.extend({},{dataUrl:"http://passer-by.com/data_location/list.json",dataType:"json",provinceField:"province",cityField:"city",areaField:"area",code:0,province:0,city:0,area:0,required:!0,nodata:"hidden",onChange:function(){}},e);return this.each(function(){var p={},e=u(this),s=e.find('select[name="'+f.provinceField+'"]'),y=e.find('select[name="'+f.cityField+'"]'),l=e.find('select[name="'+f.areaField+'"]');u.ajax({url:f.dataUrl,type:"GET",crossDomain:!0,dataType:f.dataType,jsonpCallback:"jsonp_location",success:function(o){var c,a,n,t;if(f.code){var e=f.code-f.code%1e4;o[e]&&(f.province=e),e=f.code-(f.code%1e4?f.code%100:f.code),o[e]&&(f.city=e),e=f.code%100?f.code:0,o[e]&&(f.area=e)}var d=function(){for(code in c={},a={},t=!(n={}),o)if(code%1e4){var e=code-f.province;if(f.province&&0<e&&e<1e4)if(code%100)if(9e3<e)a[code]=o[code];else if(t){var i=code-f.city;f.city&&0<i&&i<100&&(n[code]=o[code],f.required&&!f.area?f.area=code:-1<o[code].indexOf(f.area)&&(f.area=isNaN(f.area)?code:f.area))}else a[code]=o[code],f.area&&(f.city=f.area,f.area=""),f.required&&!f.city?f.city=code:-1<o[code].indexOf(f.city)&&(f.city=isNaN(f.city)?code:f.city);else t=!0,a[code]=o[code],f.required&&!f.city?f.city=code:-1<o[code].indexOf(f.city)&&(f.city=isNaN(f.city)?code:f.city)}else c[code]=o[code],f.required&&!f.province?!f.city||f.city%1e4?f.province=code:f.province=f.city:-1<o[code].indexOf(f.province)&&(f.province=isNaN(f.province)?code:f.province)},r={province:function(){for(i in s.empty(),f.required||s.append('<option value=""> - 请选择 - </option>'),c)s.append('<option value="'+i+'">'+c[i]+"</option>");f.province&&s.val(f.province),this.city()},city:function(){for(i in y.empty(),f.required||y.append('<option value=""> - 请选择 - </option>'),"disabled"==f.nodata?y.prop("disabled",u.isEmptyObject(a)):"hidden"==f.nodata&&y.css("display",u.isEmptyObject(a)?"none":""),a)y.append('<option value="'+i+'">'+a[i]+"</option>");f.city&&y.val(f.city),this.area()},area:function(){if(l.empty(),t){for(i in l.css("display",""),f.required||l.append('<option value=""> - 请选择 - </option>'),"disabled"==f.nodata?l.prop("disabled",u.isEmptyObject(n)):"hidden"==f.nodata&&l.css("display",u.isEmptyObject(n)?"none":""),n)l.append('<option value="'+i+'">'+n[i]+"</option>");f.area&&l.val(f.area)}else l.css("display","none")}};p.getInfo=function(){return{direct:!t,province:o[f.province]||"",city:o[f.city]||"",area:o[f.area]||"",code:f.area||f.city||f.province}},s.on("change",function(){f.province=u(this).val(),f.city=0,f.area=0,d(),r.city(),f.onChange(p.getInfo())}),y.on("change",function(){f.city=u(this).val(),f.area=0,d(),r.area(),f.onChange(p.getInfo())}),l.on("change",function(){f.area=u(this).val(),f.onChange(p.getInfo())}),d(),r.province(),v(p)}})})},e("city",null)});