layui.use(["form","layer","element","jquery","table"],function(){var a=layui.jquery,o=(layui.form,layui.layer),e=layui.table;layui.element;e.render({elem:"#table_content",id:"customer_search_table",url:"/sales/customer_findByPage",where:{t:(new Date).getTime(),customerName:a("#cust_search_name").val(),customerCellphone:a("#cust_search_cellphone").val(),customerType:a("#cust_search_type").val()},cols:[[{field:"customerName",align:"center",title:"客户名称"},{field:"customerType",align:"center",title:"客户类别"},{field:"customerCellphone",align:"center",title:"客户电话"},{field:"customerEmail",align:"left",title:"Email"},{field:"customerAddress",align:"left",title:"客户地址"},{fixed:"right",align:"center",title:"操作",toolbar:"#table_control_bar"}]],page:!0,loading:!0,limits:[10,20,50,90]}),a("#search").on("click",function(){e.reload("customer_search_table",{where:{t:(new Date).getTime(),customerName:a("#cust_search_name").val(),customerCellphone:a("#cust_search_cellphone").val(),customerType:a("#cust_search_type").val()}})}),e.on("tool(cust_table_filter)",function(e){var t=e.data,n=e.event;e.tr;if("select"===n){a(window.parent.document.getElementById("customer_name")).val(t.customerName),a(window.parent.document.getElementById("customer_type")).find("option").remove(),a(window.parent.document.getElementById("customer_type")).append("<option value='"+t.customerType+"' selected='true'>"+t.customerType+"</option>"),a(window.parent.document.getElementById("purchasing_contact")).find("option").remove();var l=o.load(2);a.ajax({url:"/sales/customer_links",type:"GET",data:{id:t.id},success:function(e){for(var t=0;t<e.customerlinks.length;t++)0==t?(a(window.parent.document.getElementById("purchasing_contact")).append("<option value='"+e.customerlinks[t].name+"|"+e.customerlinks[t].cellphone+"' selected='true'>"+e.customerlinks[t].name+"|"+e.customerlinks[t].cellphone+"</option>"),a(window.parent.document.getElementById("transport_address")).val(e.customerlinks[t].address),a(window.parent.document.getElementById("invoice_address")).val(e.customerlinks[t].address)):a(window.parent.document.getElementById("purchasing_contact")).append("<option value='"+e.customerlinks[t].name+"|"+e.customerlinks[t].cellphone+"'>"+e.customerlinks[t].name+"|"+e.customerlinks[t].cellphone+"</option>");a(window.parent.document.getElementById("purchasing_contact")).attr("data",JSON.stringify(e.customerlinks)),o.close(l);var n=parent.layer.getFrameIndex(window.name);parent.layer.close(n)}})}})});