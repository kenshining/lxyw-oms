layui.use(["layer","jquery","form","table","laydate"],function(){var b=layui.jquery,l=(layui.form,layui.table),t=layui.laydate,a=layui.layer;b("#search").on("click",function(){var t,e,n=b("#stock_search_date").val();""!=n&&(t=n.split("_")[0],e=n.split("_")[1]),l.reload("stock_table",{page:{curr:1},where:{t:(new Date).getTime(),productName:b("#productName_search").val(),productStatus:b("#productStatus_search").val(),start_date:t,end_date:e},loading:!0})}),t.render({elem:'input[name="stock_search_date"]',range:"-",format:"yyyy-MM-dd"}),b("#add").on("click",function(){var t=a.open({content:"/stock/stock_edit",type:2,anim:4,title:"编辑库存",btn:["保存","取消"],success:function(t,e){},yes:function(t,e){var n=a.getChildFrame("#stock_form",t),l=i(n);if(""==l)b.parseJSON(n.contents().find("#fee_container").attr("data"));else a.msg(l)}});a.full(t)}),l.render({elem:"#table_content",id:"stock_table",url:"/stock/stock_findByPage",where:{t:(new Date).getTime()},cols:[[{field:"productName",align:"center",title:"品名"},{field:"qNo",align:"center",title:"条形码"},{field:"batch",align:"center",title:"批次"},{field:"location",align:"center",title:"产地"},{field:"location",align:"center",title:"规格"},{field:"location",align:"center",title:"供应商"},{field:"state",align:"center",title:"库存状态",templet:function(t){return"0"==t.status?"女":"男"}},{fixed:"right",align:"center",title:"操作",toolbar:"#table_control_bar"}]],page:!0,loading:!0,limits:[10,20,50,90]});var i=function(t){var e=new CommonValidationUtils,n=new CommonValidationEmu,l=t.contents().find("input[name='productName']").val(),a=t.contents().find("input[name='productBatch']").val(),i=t.contents().find("input[name='productDate']").val(),o=t.contents().find("input[name='deadDate']").val(),s=t.contents().find("input[name='qno']").val(),c=t.contents().find("input[name='location']").val(),r=t.contents().find("#box_num").val(),u=t.contents().find("select[name='positon']").val(),d=t.contents().find("#plus_num").val(),f=t.contents().find("select[name='plusPosition']").val(),m=t.contents().find("#format_num").val(),p=t.contents().find("#guaranteeTime").val(),v=t.contents().find("#singleNetWeight").val(),g=t.contents().find("#singleCapacity").val(),N=(t.contents().find("#state").val(),t.contents().find("#storage").val(),t.contents().find("#wastage").val()),_=(t.contents().find("#supplierId").val(),t.contents().find("#storage_fee").val());if(e.isNull(l)||e.isNull(a)||e.isNull(s)||e.isNull(c)||e.isNull(r)||e.isNull(u)||e.isNull(d)||e.isNull(f)||e.isNull(m)||e.isNull(p)||e.isNull(v)||e.isNull(g)||e.isNull(N)||e.isNull(i)||e.isNull(o)||e.isNull(_))return n.errorMsg.all_not_null;for(var y=b.parseJSON(t.contents().find("#fee_container").attr("data")),h=0;h<y.length;h++){if(e.isNull(y[h].fee))return"未设置["+y[h].type+"],若无需保存此项，请删除。";if(!e.isNumber(y[h].fee)&&!e.isDecimal(y[h].fee))return"["+y[h].type+"],要求输入数字。"}return""}});